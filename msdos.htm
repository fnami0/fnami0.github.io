<HTML>
<HEAD>
<TITLE>fnami: MS-DOS &amp; Windows</TITLE>
</HEAD>
<BODY>

<H1>MS-DOSとWindows</H1>

<UL>
<LI><A HREF="#1">MS-DOSのおもしろいコマンド</A>
<UL>
<LI><A HREF="#1.1">COPYコマンド</A>
<LI><A HREF="#1.2">COPYコマンドとXCOPYコマンド</A>
<LI><A HREF="#1.3">DELコマンドとDELTREEコマンド</A>
<LI><A HREF="#1.4">VERコマンド</A>
<LI><A HREF="#1.5">ECHOコマンド</A>
</UL>
<LI><A HREF="#2">PC-9800シリーズのMS-DOS</A>
<UL>
<LI><A HREF="#2.1">CLOCK</A>
</UL>
<LI><A HREF="#3">Windows 95で困ったこと</A>
<UL>
<LI><A HREF="#3.1">長いファイル名の扱い</A>
<LI><A HREF="#3.2">ネットワークドライバの組み込み</A>
<LI><A HREF="#3.3">時刻が狂う</A>
<LI><A HREF="#3.4">ネットワークとレジューム</A>
<LI><A HREF="#3.5">起動時や終了時のグラフィックがうっとうしい</A>
</UL>
<LI><A HREF="#4">キーボードで使うWindows 95</A>
<UL>
<LI><A HREF="#4.1">基本</A>
<LI><A HREF="#4.2">右ボタンの代わり</A>
<LI><A HREF="#4.3">フォルダ</A>
<LI><A HREF="#4.4">カット&amp;ペースト</A>
<LI><A HREF="#4.5">MS-DOSプロンプト</A>
<LI><A HREF="#4.6">MS-DOSプロンプトの登録</A>
<LI><A HREF="#4.7">その他</A>
</UL>
<LI><A HREF="#5">マイクロソフト株式会社へのリンク（FAQのようなもの）</A>
</UL>

<HR>

<H2><A NAME="1">MS-DOSのおもしろいコマンド</A></H2>

<H3><A NAME="1.1">COPYコマンド</A></H3>

COPYコマンドは奥が深く、コピー以外にファイルの連結ができるのは有名である。これの応用として、テキストファイルの終わりに^Zをつけたりとったりできる。

<PRE>
つける:	COPY file+NUL
とる:	COPY /B file+NUL
</PRE>
ただし後者は、MS-DOS5.0以降では「デバイスからバイナリ形式の読み取りはできません.」というエラーになってしまうので、NULの代わりに適当な大きさ0のファイルを作って使う。

<H3><A NAME="1.2">COPYコマンドとXCOPYコマンド</A></H3>

COPYコマンドでは、大きさが0のファイルはコピーされない。コピーしたいときには、XCOPYコマンドを使うとよい。

<H3><A NAME="1.3">DELコマンドとDELTREEコマンド</A></H3>

<P>DELコマンドでは、書込み禁止やシステムなどの属性のついたファイルを削除できない。DELTREEコマンドでは削除できる。DELTREEコマンドは引数にディレクトリ名だけでなくファイル名を指定してもよいし、複数の引数も受け付ける。しかも、ファイル名やディレクトリ名をワイルドカードを使って指定できる。

<P>DELTREEコマンドを使うと、Windows 95の長いファイル名のエントリもMS-DOSから削除できるので便利である。

<H3><A NAME="1.4">VERコマンド</A></H3>

これは本来、MS-DOSのバージョンを表示するコマンドだが、/Rスイッチをつけると、リビジョンと、MS-DOSがHMAにあるかどうかを表示してくれる。しかし、表示されるリビジョンは「A」以外見たことがない。

<H3><A NAME="1.5">ECHOコマンド</A></H3>

DOS 3以降では、
<PRE>
	ECHO.
</PRE>
とすると改行だけを出力できる。

<HR>

<H2><A NAME="2">PC-9800シリーズのMS-DOS</A></H2>

<H3><A NAME="2.1">CLOCK</A></H3>

PC-9800シリーズのMS-DOSではクロックデバイスの名前はCLOCKとなっており、普通のファイル名やディレクトリ名として、CLOCKそのものや、CLOCK.なんとかは使えない。しかし、例えばサンマイクロシステムズのJAVA開発キットのDEMOディレクトリの下にはCLOCKというディレクトリがあるなど、CLOCKという名前が使われていることは意外と多い。Windows 95では、クロックデバイスの名前はCLOCK$に変更された。

<HR>

<H2><A NAME="3">Windows 95で困ったこと</A></H2>

<H3><A NAME="3.1">長いファイル名の扱い</A></H3>

<UL>
<LI>MS-DOSモードでは、長いファイル名を扱えない。MS-DOSプロンプトでなら扱える。COPYコマンドやXCOPYコマンドでコピーすることができる。転送元に大文字小文字を間違えて指定しても、転送先がドライブやディレクトリ指定だけなら、転送先には正しくコピーされる。ただし、XCOPYコマンドで転送先のディレクトリを作成するときには、ディレクトリ名は正しく(大文字小文字を間違えずに)指定する必要がある。
<LI>CD-ROM Extrasに含まれている、LFNBKユーティリティを使うと、長いファイル名の情報をルートディレクトリのファイルに入れて、短いファイル名だけを残し、後で戻すようにできる。ただし、Windows 95で、[古いプログラムに長いファイル名を使わない]をチェックした状態で使う必要がある。また、長いファイル名が保存されたファイルはバイナリファイルであるため、長いファイル名がついていたファイルのドライブやディレクトリを移動してしまうと、復元できない。
<LI>長いファイル名を持つファイルの短い名前と同じになるように、別のファイルの名前を変えようとすると、MS-DOSプロンプトではエラーになるが、GUI経由だと最初のファイルの短いファイル名が変更されてしまう。
</UL>

<H3><A NAME="3.2">ネットワークドライバの組み込み</A></H3>

標準でないPCIネットワークアダプタを取り付けたままインストールしたときには、ネットワークドライバの組み込み手順を誤ると、ネットワークが使えない。必ず、自動検出されたPCI Ethernet Adapter（[デバイスマネージャ]の[その他のデバイス]に入っている）のドライバとして組み込むこと。ネットワークアダプタの追加として組み込むと動作しない。

<H3><A NAME="3.3">時刻が狂う</A></H3>

PC-9800シリーズでレジュームを使った場合、レジューム後に書き込んだファイルのタイムスタンプが、古い時刻になってしまう。MS-DOS上では、このようなことはない。回避するには、フリーソフトの<A HREF="http://www.vector.co.jp/vpack/filearea/win95/util/note/index.html">RESTIME</A>を使う。

<P>上の問題は、97年5月にMicrosoftのページに追加された、<A HREF="http://www.microsoft.com/japan/win95/modules/98_409.htm">タイマードライバのアップデート</A>(OSR2かどうかで使うモジュールが異なるので注意)では、一部しか解決しない。確かに時刻は正しくなるが、サスペンド中に日付が変わった場合は、日付が古いままになる。このモジュールには、レジューム後に遅くなる問題を解決する働きもあるので、上のフリーソフトと併用するとよい。

<P>IBM-PC互換機(Digital HiNote Ultra (BIOS更新済み) で確認)でも同様の症状が出る。回避するにはシェアウェアの<A HREF="http://www.vector.co.jp/vpack/filearea/win95/personal/tokei/tool/index.html">Japan Standard Time for Win95</A>を使う。

<H3><A NAME="3.4">ネットワークとレジューム</A></H3>

私は、モデムカードを使ったダイヤルアップアダプタと、LANカードの二つのネットワークドライバを組み込んでIPを利用しているが、どちらもレジューム後はうまく動作しなくなる。ダイヤルアップアダプタは、レジューム後にうっかり使ってしまった場合、ドライバをいったん削除して、再び追加する必要がある。LANカードの場合には、ドライバの再追加は必要ないが、レジュームはもちろん、カードの抜き差しだけで使えなくなってしまう。いやそれどころか、起動時にカードが入っていないと使えない。

<P>ダイヤルアップアダプタのドライバを削除したら、LANカードは正しく使えるようになった。ドライバを削除する代わりに、[TCP/IP -> ダイヤルアップアダプタ]の[プロパティ]で、[IPアドレスを指定]をやめて[IPアドレスを自動的に取得]を選ぶと、ダイヤルアップアダプタもLANカードも正しく使えるようになった。なお、インターネットエクスプローラはレジュームに対応していないらしく、レジューム後はLANカードが動作しているにもかかわらず、ローカルファイル以外を新たに開くことができない。インターネットエクスプローラを終了して再起動する必要がある。

<P>

<H2><A NAME="3.5">起動時や終了時のグラフィックがうっとうしい</A></H2>

起動時や終了時に表示される、Windows 95のグラフィックはうっとうしい。次のようにすれば表示されないようにできる。

<P>ルートディレクトリにあるMSDOS.SYSファイルに次の行を付け加えると、起動時のグラフィックを非表示にできる。
<PRE>LOGO=0
</PRE>

<P>WINDOWSディレクトリにあるLOGOS.SYSとLOGOW.SYSの二つのファイルを削除すると、終了時のグラフィックを非表示にできる。

<HR>

<H2><A NAME="4">キーボードで使うWindows 95</A></H2>

<P>私はマウスが苦手なので、Windows 95の操作はなるべくキーボードで行うようにしている。Windows 95はかなりの操作がキーボードだけでできるので便利である。ここでは、キーボードで使うときのヒントを説明する。

<P>キーの名前の表記にはPC-9800シリーズのキーボードのものを使っている。IBM PC互換機では次のように読み替える。

<PRE>
GRPH	Alt
RET	Enter
</PRE>

<H3><A NAME="4.1">基本</A></H3>

<P>基本は次のキーである。

<PRE>
カーソルキー	移動
RET		選択
ESC		キャンセル
f1		ヘルプ
GRPH+f4		終了
TAB		項目間の移動(SHIFTつきで逆移動)
CTRL+TAB	大きな項目間の移動(SHIFTつきで逆移動)
GRPH+TAB	タスクの切り替え(GRPHを押しながらTABを押すたびにタスクの名前が表示され、
		離すと選択される。SHIFTつきで逆移動、ESCで中止もできる)
CTRL+ESC	スタート
GRPH+ESC	ウィンドウの切り替え(タスクバーに出ないウィンドウにも切り替えられる。
		SHIFTつきで逆移動)
GRPH+SPACE	ウィンドウのメニューの表示(ウィンドウの移動やサイズ変更ができる。
		微調整はCTRL+カーソルキーで)
GRPH+Fなど	ファイルメニューなどの表示
</PRE>

<H3><A NAME="4.2">右ボタンの代わり</A></H3>

<P>次のキーを覚えておくと、マウスの右ボタンを押す必要がなくなる。

<PRE>
GRPH+RET	プロパティ
SHIFT+f10	ショートカットメニュー
</PRE>

<H3><A NAME="4.3">フォルダ</A></H3>

<P>フォルダで便利なのは次のキーである。

<PRE>
BS		一つ上の階層のフォルダを開く
SHIFT+GRPH+f4	フォルダとそのすべての親フォルダを閉じる
DEL		ごみ箱に移動
SHIFT+DEL	削除
f2		ファイル名変更
CTRL+RET	フォルダを開くときに新しいウィンドウを作るかどうかが反転
SHIFT+RET	フォルダをエクスプローラで開く
</PRE>

<P>SHIFT+DELを使うと、デスクトップのMSNやインターネットエクスプローラなどのじゃまなアイコンを消すこともできる。

<H3><A NAME="4.4">カット&amp;ペースト</A></H3>

<P>SHIFT+カーソルキーで範囲の指定ができる。文字情報だけでなく、フォルダの中身なども指定できる。CTRL+Aですべてを選択できる。CTRL+Cは範囲のコピー、CTRL+Xは範囲のカット、CTRL+Vはペーストである。

<H3><A NAME="4.5">MS-DOSプロンプト</A></H3>

<P>Windows 95では、MS-DOSプロンプトからWindowsアプリケーションを起動できるようになった。FDのようなファイル管理ツールからも起動可能である。MS-DOSプロンプトがあれば、スタートメニューの[ファイル名を指定して実行]の機能は不要であるし、アプリケーションの名前を覚えてしまえば、スタートメニューを見る必要もない。

<P>IPネットワーク関係

<PRE>
TELNET		telnet
FTP		ftp
PING		ping
ROUTE		route
TRACERT		traceroute
NETSTAT		netstat
</PRE>

<P>アクセサリなど

<PRE>
WINHELP		ヘルプ
NOTEPAD		メモ帳
SYSMON		システムモニター
QFECHECK	アップデート情報ツール
POLEDIT		システムポリシーエディタ
REGEDIT		レジストリエディタ
WELCOME		Windows 95へようこそ
\WINDOWS\SYSTEM\SYSEDIT
		システムエディタ
START <EM>ファイル名</EM>
		開く(関連付けられたアプリケーションを実行)
		ファイル名の代わりにURLを指定すれば、WWWブラウザが起動する。
</PRE>

あまり必要ないと思うが、STARTコマンドではディレクトリ(フォルダ)も開くことができる。

<H3><A NAME="4.6">MS-DOSプロンプトの登録</A></H3>

MS-DOSプロンプトが起動してしまうと楽なので、ショートカットキーを登録しておくとよい。登録はキーボードだけでできる。
<UL>
<LI>MS-DOSプロンプトを起動する
<UL>
<LI>CTRL+ESCを押す。
<LI>[プログラム(P)]を選ぶ(Pを押す)。
<LI>[MS-DOSプロンプト]を選ぶ(Mを押す。Mで始まる項目が複数あるときは、何回かMを押してRETを押す)。
</UL>
<LI>ショートカットを設定する。
<UL>
<LI>GRPH+SPACEを押してメニューを出し、[プロパティ(P)]を選ぶ。
<LI>[MS-DOSプロンプトのプロパティ]ダイアログボックスの[プログラム]画面に行き(CTRL+TABを使うと便利)、[アクセスキー]に適当なキーの組み合わせを入力する。
<LI>RETを押す。
</UL>
</UL>

<H3><A NAME="4.7">その他</A></H3>

<PRE>
SPACE		チェックをON/OFF
f4		一覧やヒストリを表示(▼をクリックする代わり)(終了はESC)
→		階層を開く
←		階層を閉じる
</PRE>

Windowsディレクトリのファイル<A HREF="file://\WINDOWS\TIPS.TXT">TIPS.TXT</A>にもいろいろおもしろいヒントが書かれているので参照するとよい。

<HR>

<H2><A NAME="5">マイクロソフト株式会社へのリンク（FAQのようなもの）</A></H2>

<UL>
<LI><A HREF="http://www.microsoft.com/japan/support/tdoc/doc/win95/">Windows 95 サポート技術情報</A>
<LI><A HREF="http://www.microsoft.com/japan/support/tdoc/doc/winnt/">Windows NT サポート技術情報</A>
<LI><A HREF="http://www.microsoft.com/japan/developer/winds/SDK/sdk.htm">Win32 SDKに関する情報</A>
<LI><A HREF="http://www.microsoft.com/japan/developer/winds/DDK/ddk.htm">Win32 DDKに関する情報</A>
<LI><A HREF="http://www.microsoft.com/japan/support/tdoc/doc/DirectX/">DirectX SDKに関する情報</A>
</UL>

</BODY>
</HTML>
